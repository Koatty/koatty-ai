import { Service, Autowired } from 'koatty';
import { {{pascalCase module}}Model } from '../model/{{pascalCase module}}Model';
import { Create{{pascalCase module}}Dto, Update{{pascalCase module}}Dto, Query{{pascalCase module}}Dto } from '../dto/{{pascalCase module}}Dto';

@Service()
export class {{pascalCase module}}Service {
  @Autowired()
  private {{camelCase module}}Model: {{pascalCase module}}Model;

  /**
   * 分页查询
   */
  async findAll(query: Query{{pascalCase module}}Dto) {
    const { page = 1, pageSize = 10, ...filters } = query;
    return this.{{camelCase module}}Model.list(filters, page, pageSize);
  }

  /**
   * 根据 ID 查询
   */
  async findById(id: number) {
    return this.{{camelCase module}}Model.get(id);
  }

  /**
   * 创建
   */
  async create(dto: Create{{pascalCase module}}Dto) {
    return this.{{camelCase module}}Model.add(dto);
  }

  /**
   * 更新
   */
  async update(id: number, dto: Update{{pascalCase module}}Dto) {
    return this.{{camelCase module}}Model.update(id, dto);
  }

  /**
   * 删除
   */
  async delete(id: number) {
    return this.{{camelCase module}}Model.delete(id);
  }

  {{#if features.softDelete}}
  /**
   * 软删除
   */
  async softDelete(id: number) {
    return this.{{camelCase module}}Model.update(id, {
      deletedAt: new Date()
    });
  }
  {{/if}}
}
